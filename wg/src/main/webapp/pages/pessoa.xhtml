<?xml version="1.0" encoding="ISO-8859-1" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	template="/templates/principal.xhtml">

	<ui:define name="menu">
		<ui:include src="/includes/menu.xhtml"></ui:include>
	</ui:define>

	<ui:define name="conteudo">
		<h3>
			<h:outputText value="#{msgs.cadPessoas}" />
		</h3>
		<h:form id="frmGridPessoas">
			<p:toolbar id="mnuOp">
				<f:facet name="left">
					<p:commandButton value="#{msgs.novaPessoa}"
						actionListener="#{pessoaBean.novo()}"
						oncomplete="PF('dlgNovaPessoa').show()"
						update=":frmPessoaNova:pnlPessoaNova" />
				</f:facet>
			</p:toolbar>
			<p:dataTable id="gridPessoas" var="pessoa" widgetVar="tblPessoas"
				styleClass="table" filteredValue="#{pessoaBean.pessoasFiltradas}"
				value="#{pessoaBean.pessoas}" rows="10" paginator="true"
				emptyMessage="#{msgs.semDados}" rowKey="#{pessoa.id}"
				selection="#{pessoaBean.pessoa}" selectionMode="single"
				paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
				rowsPerPageTemplate="10,30,50,100">
				<p:column headerText="ID" style="width:60px;text-align:center;">
					<h:outputText value="#{pessoa.id}" />
				</p:column>

				<p:column headerText="#{msgs.nome}" sortBy="#{pessoa.nome}"
					style="width:400px;" filterBy="#{pessoa.nome}"
					filterMatchMode="contains">
					<h:outputText value="#{pessoa.nome}" />
				</p:column>

				<p:column headerText="#{msgs.tipo}" sortBy="#{pessoa.tipoPessoa}">
					<h:outputText value="#{pessoa.tipoPessoa}" />
				</p:column>

				<p:column headerText="#{msgs.cpfcnpj}" filterBy="#{pessoa.cpfCnpj}">
					<h:outputText value="#{pessoa.cpfCnpj}" />
				</p:column>

				<p:column headerText="#{msgs.cadastroEm}"
					sortBy="#{pessoa.tsRegistro}"
					style="width:100px;text-align:center;">
					<h:outputText value="#{pessoa.tsRegistro}">
						<f:convertDateTime pattern="dd/MM/yyyy" locale="pt" />
					</h:outputText>
				</p:column>

				<p:column headerText="#{msgs.atualizadoEm}"
					sortBy="#{pessoa.tsAtualizacao}"
					style="width:100px;text-align:center;">
					<h:outputText value="#{pessoa.tsAtualizacao}">
						<f:convertDateTime pattern="dd/MM/yyyy" locale="pt" />
					</h:outputText>
				</p:column>

				<p:column headerText="#{msgs.comandos}">
					<p:commandButton title="#{msgs.editarPessoa}" icon="ui-icon-pencil"
						oncomplete="PF('dlgEditarPessoa').show()"
						update=":frmPessoaEditar:pnlPessoaEditar">
						<f:setPropertyActionListener value="#{imovel}"
							target="#{pessoaBean.pessoa}" />
					</p:commandButton>
					<p:commandButton title="#{msgs.excluirPessoa}" icon="ui-icon-trash"
						oncomplete="PF('dlgExcluirPessoa').show()"
						update=":frmPessoaExcluir:pnlPessoaExcluir">
						<f:setPropertyActionListener value="#{pessoa}"
							target="#{pessoaBean.pessoa}" />
					</p:commandButton>
				</p:column>
			</p:dataTable>
		</h:form>


		<p:dialog header="#{msgs.cadastrarNovaPessoa}"
			widgetVar="dlgNovaPessoa" responsive="true" modal="true"
			appendTo="@(body)" resizable="false" closable="true"
			draggable="false" height="520" width="1000">
			<h:form id="frmPessoaNova">
				<h:panelGrid id="pnlPessoaNova" columns="2">
					<p:outputLabel value="Tipo:" for="cdTiposPessoa" />
					<p:selectOneMenu id="cdTiposPessoa"
						value="#{pessoaBean.pessoa.tipoPessoa}" required="true"
						requiredMessage="#{msgs.msgTipoObrigatorio}">
						<f:selectItem itemLabel="#{msgs.selecione}..." itemValue="" />
						<f:selectItem itemLabel="#{msgs.fisica}" itemValue="F" />
						<f:selectItem itemLabel="#{msgs.juridica}" itemValue="J" />
					</p:selectOneMenu>
					<p:outputLabel value="#{msgs.nome}:" for="txtNome" />
					<p:inputText id="txtNome" size="60" maxlength="50"
						placeholder="#{msgs.nome}" value="#{pessoaBean.pessoa.nome}"
						required="true" requiredMessage="#{msgs.msgNomeObrigatorio}" />
					<p:outputLabel value="#{msgs.cpfcnpj}:" for="txtCpfCnpj" />
					<p:inputText id="txtCpfCnpj" size="20" maxlength="20"
						placeholder="#{msgs.cpfcnpj}" value="#{pessoaBean.pessoa.cpfCnpj}"
						required="true" requiredMessage="#{msgs.msgCpfCnpjObrigatorio}" />
					<p:outputLabel value="#{msgs.rgie}:" for="txtRgIe" />
					<p:inputText id="txtRgIe" size="20" maxlength="20"
						placeholder="#{msgs.rgie}" value="#{pessoaBean.pessoa.rgIe}" />
					<p:outputLabel value="#{msgs.endereco}:" />
					<p:inputText size="50" maxlength="40"
						value="#{pessoaBean.pessoa.endereco}" required="true"
						requiredMessage="#{msgs.msgEnderecoObrigatorio}" />
					<p:outputLabel value="#{msgs.complemento}:" />
					<p:inputText size="50" maxlength="40"
						value="#{pessoaBean.pessoa.complemento}" />
					<p:outputLabel value="#{msgs.bairro}:" />
					<p:inputText size="40" maxlength="30"
						value="#{pessoaBean.pessoa.bairro}" />
					<p:outputLabel value="#{msgs.cidade}" for="cbCidades" />
					<p:selectOneMenu id="cbCidades" value="#{pessoaBean.pessoa.cidade}" converter="omnifaces.SelectItemsConverter" required="true"
						requiredMessage="#{msgs.msgCidadeObrigatorio}" >
						<f:selectItem itemLabel="#{msgs.selecione}..." noSelectionOption="true" />
						<f:selectItems value="#{pessoaBean.cidades}" var="cidade" itemLabel="#{cidade.nome}" itemValue="#{cidade}"/>
					</p:selectOneMenu>					
					<p:outputLabel value="#{msgs.cep}" />
					<p:inputText maxlength="5" size="10"
						value="#{pessoaBean.pessoa.cep}"
						converterMessage="Informe um valor válido para o campo 'CEP'"
						validatorMessage="Informe um valor entre 0 e 99999999 para o campo CEP">
						<f:validateLongRange minimum="0" maximum="99999999" />
					</p:inputText>
					<p:outputLabel value="#{msgs.emailPrincipal}:" />
					<p:inputText size="60" maxlength="100"
						value="#{pessoaBean.pessoa.emailPrincipal}" />					
					<p:outputLabel value="#{msgs.emailAlternativo}:" />
					<p:inputText size="60" maxlength="110"
						value="#{pessoaBean.pessoa.emailAlternativo}" />					
					<p:outputLabel value="#{msgs.foneFixo}:" />
					<p:inputText size="14" maxlength="20"
						value="#{pessoaBean.pessoa.foneFixo}" />					
					<p:outputLabel value="#{msgs.foneCel1}:" />
					<p:inputText size="14" maxlength="20"
						value="#{pessoaBean.pessoa.foneCel1}" />					
					<p:outputLabel value="#{msgs.foneCel2}:" />
					<p:inputText size="14" maxlength="20"
						value="#{pessoaBean.pessoa.foneCel2}" />					
					
					<p:toolbar>
						<f:facet name="right">
							<p:commandButton value="#{msgs.gravar}"
								actionListener="#{pessoaBean.novo}"
								oncomplete="verificar(xhr, status, args, 'dlgNovaPessoa', 'tblPessoas');"
								update=":frmGridPessoas:gridPessoas :msgGlobal" />&nbsp;&nbsp;&nbsp;&nbsp;
							<p:commandButton value="#{msgs.cancelar}" process="@this"
								onclick="PF('dlgNovaPessoa').hide()">
								<p:resetInput target="pnlPessoaNova" />
							</p:commandButton>
						</f:facet>
					</p:toolbar>
				</h:panelGrid>
				<p:outputLabel value="* #{msgs.obrigatorio}" />
			</h:form>

		</p:dialog>

		<p:dialog header="#{msgs.excluirPessoa}" widgetVar="dlgExcluirPessoa"
			modal="true" appendTo="@(body)" resizable="false" closable="true"
			draggable="false" height="180" width="550">
			<h:form id="frmPessoaExcluir">
				<p>
					<b><h:outputText value="#{msgs.msgExcluirImovel}" /></b>
				</p>
				<h:panelGrid id="pnlPessoaExcluir" columns="2">
					<h:outputLabel value="#{msgs.codigo}" />
					<h:outputText value="#{pessoaBean.pessoa.id}" />
					<h:outputLabel value="#{msgs.nome}" />
					<h:outputText value="#{pessoaBean.pessoa.nome}" />
				</h:panelGrid>
				<p>
					<h:panelGrid columns="1">
						<p:toolbar style="width:500px">
							<f:facet name="right">
								<p:commandButton value="#{msgs.sim}"
									actionListener="#{pessoaBean.excluir}"
									oncomplete="PF('dlgExcluirPessoa').hide();"
									update=":frmGridPessoas:gridPessoas :msgGlobal" />&nbsp;&nbsp;&nbsp;&nbsp;
								<p:commandButton value="#{msgs.cancelar}" process="@this"
									onclick="PF('dlgExcluirPessoa').hide()" />
							</f:facet>
						</p:toolbar>
					</h:panelGrid>
				</p>
			</h:form>

		</p:dialog>

		<p:dialog header="#{msgs.editarPessoa}" widgetVar="dlgEditarPessoa"
			modal="true" appendTo="@(body)" resizable="false" closable="true"
			draggable="false" height="520" width="1000">
			<h:form id="frmPessoaEditar">
				<h:panelGrid id="pnlPessoaEditar" columns="2">
					<p:outputLabel value="ID" />
					<h:outputText value="#{pessoaBean.pessoa.id}" />
					<p:outputLabel value="#{msgs.codigo}" />


					<p:toolbar>
						<f:facet name="right">
							<p:commandButton value="#{msgs.gravar}"
								actionListener="#{pessoaBean.editar}"
								oncomplete="verificar(xhr, status, args, 'dlgEditarPessoa', 'tblPessoas');"
								update=":frmGridPessoas:gridPessoas :msgGlobal" />&nbsp;&nbsp;&nbsp;&nbsp;
							<p:commandButton value="#{msgs.cancelar}" process="@this"
								onclick="PF('dlgEditarPessoa').hide()">
								<p:resetInput target="pnlPessoaEditar" />
							</p:commandButton>
						</f:facet>
					</p:toolbar>
				</h:panelGrid>
			</h:form>
		</p:dialog>
	</ui:define>

</ui:composition>